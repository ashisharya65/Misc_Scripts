# PowerShell scripts to create Event Triggered scheduled tasks
This repo contains the scripts which I used recently to create event triggered scheduled task on Intune managed VMs so as to shutdown the unused VMs.
1. The [DeviceShutdownEventTriggeredSchdTask.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/DeviceShutdownEventTriggeredSchdTask.ps1) script will be creating the first schd task for monitoring the user log off event (event id - 4647) and whenever the event is generated, it will shutdown the device after waiting for 30 mins. 
2. The second [Reset-ShutdownEventTriggeredSchdTask.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/Reset-ShutdownEventTriggeredSchdTask.ps1) script is used for the case when a device is already got the first scheduled task and waiting for the 30 mins to be completed in order to shut down the device but then suddenly the user before the completion of 30 mins wants to use his/her device. For this case this second script will create will be creating the another scheduled task for monitoring the user connect event and whenever the event is generated, it will reset (disable & enable) the first scheduled task on the device which was created by [DeviceShutdownEventTriggeredSchdTask.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/DeviceShutdownEventTriggeredSchdTask.ps1) script. The reset will reset the 30 mins of waiting time of first schedulte task and then the scheduler 1 will monitor again for the user log off event. Finally, to reset the first schd task [Reset.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/Reset.ps1) script will be used by the second scheduled task.
