# PowerShell scripts to create Event Triggered schd tasks
This repo contains the scripts which I used recently to create event triggered schd task on Intune managed VMs so as to shutdown the unused VMs.
1. The [DeviceShutdownEventTriggeredSchdTask.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/DeviceShutdownEventTriggeredSchdTask.ps1) script will be creating the first schd task for monitoring the user log off event (event id - 4647) and whenever the event is generated, it will shutdown the device after waiting for 30 mins. 
2. The second [Reset-ShutdownEventTriggeredSchdTask.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/Reset-ShutdownEventTriggeredSchdTask.ps1) script is used for the case suppose a device has already got the first schd task and waiting for the 30 mins to be completed in order to shut down the device and suddenly during that time, the user (before the completion of 30 mins) wants to use his/her device. For this case, this second script will be creating another schd task for monitoring the user connect event and whenever the event is generated, it will reset (disable & enable) the first schd task on the device. After reset, the first schd task will again start monitoring for the user log off event. 
3. Finally, to reset the first schd task [Reset.ps1](https://github.com/ashisharya65/My-PowerShell-Scripts/blob/main/WindowsMachines/ScheduledTask/EventTriggeredSchdTask/Reset.ps1) script will be used by the second schd task.
